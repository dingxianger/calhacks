"use strict";var t=require("react"),e=require("../../animation/utils/is-animation-controls.cjs"),n=require("../../context/PresenceContext.cjs"),r=require("../../render/utils/resolve-variants.cjs"),i=require("../../utils/use-constant.cjs"),o=require("../../value/utils/resolve-motion-value.cjs"),s=require("../../context/MotionContext/index.cjs"),a=require("../../render/utils/is-controlling-variants.cjs");function u(t,n,i,s){const u={},l=s(t,{});for(const t in l)u[t]=o.resolveMotionValue(l[t]);let{initial:c,animate:v}=t;const f=a.isControllingVariants(t),m=a.isVariantNode(t);n&&m&&!f&&!1!==t.inherit&&(void 0===c&&(c=n.initial),void 0===v&&(v=n.animate));let x=!!i&&!1===i.initial;x=x||!1===c;const d=x?v:c;if(d&&"boolean"!=typeof d&&!e.isAnimationControls(d)){(Array.isArray(d)?d:[d]).forEach((e=>{const n=r.resolveVariantFromProps(t,e);if(!n)return;const{transitionEnd:i,transition:o,...s}=n;for(const t in s){let e=s[t];if(Array.isArray(e)){e=e[x?e.length-1:0]}null!==e&&(u[t]=e)}for(const t in i)u[t]=i[t]}))}return u}exports.makeUseVisualState=e=>(r,o)=>{const a=t.useContext(s.MotionContext),l=t.useContext(n.PresenceContext),c=()=>function({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,i,o){const s={latestValues:u(r,i,o,t),renderState:e()};return n&&(s.mount=t=>n(r,t,s)),s}(e,r,a,l);return o?c():i.useConstant(c)};
