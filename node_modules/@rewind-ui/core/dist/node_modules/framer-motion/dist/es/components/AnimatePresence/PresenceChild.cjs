"use strict";var e=require("react"),t=require("../../context/PresenceContext.cjs"),r=require("../../utils/use-constant.cjs"),n=require("./PopChild.cjs");function s(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var o=s(e);function i(){return new Map}exports.PresenceChild=({children:s,initial:c,isPresent:u,onExitComplete:a,custom:l,presenceAffectsLayout:f,mode:d})=>{const p=r.useConstant(i),P=e.useId(),m=e.useMemo((()=>({id:P,initial:c,isPresent:u,custom:l,onExitComplete:e=>{p.set(e,!0);for(const e of p.values())if(!e)return;a&&a()},register:e=>(p.set(e,!1),()=>p.delete(e))})),f?void 0:[u]);return e.useMemo((()=>{p.forEach(((e,t)=>p.set(t,!1)))}),[u]),o.useEffect((()=>{!u&&!p.size&&a&&a()}),[u]),"popLayout"===d&&(s=o.createElement(n.PopChild,{isPresent:u},s)),o.createElement(t.PresenceContext.Provider,{value:m},s)};
